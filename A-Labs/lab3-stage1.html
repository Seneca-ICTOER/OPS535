<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab3-stage1">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OPS535/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OPS535/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OPS535/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OPS535/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OPS535/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 3 Part 1 | OPS535 Course Title</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab3-stage1"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 3 Part 1 | OPS535 Course Title"><meta data-rh="true" name="description" content="Lab 3 Stage 1"><meta data-rh="true" property="og:description" content="Lab 3 Stage 1"><link data-rh="true" rel="icon" href="/OPS535/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab3-stage1"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab3-stage1" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab3-stage1" hreflang="x-default"><link rel="stylesheet" href="/OPS535/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OPS535/assets/js/runtime~main.234e0372.js" as="script">
<link rel="preload" href="/OPS535/assets/js/main.43f4e331.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OPS535/"><div class="navbar__logo"><img src="/OPS535/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OPS535/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OPS535 Course Title</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/">Welcome to OPS535</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OPS535/A-Labs/prelab0">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/prelab0">Pre Lab 0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab1-alt">Lab 1 Alternate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab2-stage1">Lab 2 Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab2-stage2">Lab 2 Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OPS535/A-Labs/lab3-stage1">Lab 3 Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab3-stage2">Lab 3 Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab4-home">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab4-vl">Lab 4 Alternate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/C-ExtraResources/required-material-list">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OPS535/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 3 Part 1</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 3 - Stage 1</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="purpose">Purpose<a class="hash-link" href="#purpose" title="Direct link to heading">​</a></h2><p>The OpenLDAP software package is a Free and Open Source implementation of the Lightweight Directory Access Protocol (LDAP). It is gaining wide acceptance as the directory access method of the Internet and also with corporate intranets. In this lab, you set up and configure an OpenLDAP server to provide directory service for LDAP Clients to authenticate network users. You can use OpenLDAP server to replace NIS to centrally store network user account information for OpenLDAP client to authenticate network users. The basic components of an LDAP server are its Object Classes and Attribute types defined in one or more Schema. To provide the necessary attribute types (ie. Field) for storing Linux (or Unix, aka Posix) user accounts, you need to include the “cosine”, “nis”, and “inetorgperson” schemata in addition to the “core” schema. Notes: OpenLDAP Use TCP port 389 for regular network communication between clients and servers, and use port 636 for encrypted network communication between clients and servers. If you have firewalls between your LDAP server and LDAP clients, you need to open the above TCP ports on the firewall to allow LDAP traffic to get through.</p><p>Designate vm1 as your LDAP server and use vm2 and vm3 as LDAP clients</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-requisites">Pre-Requisites<a class="hash-link" href="#pre-requisites" title="Direct link to heading">​</a></h2><p>The pre-lab must be complete so that your virtual machines share access to a private network. Lab 1 must be complete so each machine has a well configured firewall. Make sure each machine is fully updated.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_authentication_and_authorization_in_rhel/configuring-sssd-to-use-ldap-and-require-tls-authentication_configuring-authentication-and-authorization-in-rhel" target="_blank" rel="noopener noreferrer">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_authentication_and_authorization_in_rhel/configuring-sssd-to-use-ldap-and-require-tls-authentication_configuring-authentication-and-authorization-in-rhel</a></li><li><a href="https://www.golinuxcloud.com/configure-openldap-with-tls-certificates/" target="_blank" rel="noopener noreferrer">https://www.golinuxcloud.com/configure-openldap-with-tls-certificates/</a></li><li><a href="https://www.golinuxcloud.com/ldap-client-rhel-centos-8" target="_blank" rel="noopener noreferrer">https://www.golinuxcloud.com/ldap-client-rhel-centos-8</a></li><li><a href="https://kifarunix.com/configure-sssd-for-openldap-authentication-on-centos-8/" target="_blank" rel="noopener noreferrer">https://kifarunix.com/configure-sssd-for-openldap-authentication-on-centos-8/</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-1-openldap-server-setup-and-configuration">Investigation 1: OpenLDAP Server Setup and Configuration<a class="hash-link" href="#investigation-1-openldap-server-setup-and-configuration" title="Direct link to heading">​</a></h2><p><strong>Warning: Make a backup before you start this lab. It is very difficult to recover this service if you make a mistake in configuration.</strong></p><p><strong>Perform the following steps on vm1</strong></p><ol><li><p>Install yum-utils</p></li><li><p>Install the symas ldap repo (who now maintain a version of it available for Centos 8:</p><ul><li>yum-config-manager --add-repo=<a href="https://repo.symas.com/configs/SOFL/rhel8/sofl.repo" target="_blank" rel="noopener noreferrer">https://repo.symas.com/configs/SOFL/rhel8/sofl.repo</a></li></ul></li><li><p>Install the following packages</p><ul><li>openldap</li><li>symas-openldap-clients</li><li>symas-openldap-servers</li><li>perl</li></ul></li><li><p>In older releases a package called &#x27;migrationtools&#x27; was available that contained a number of perl scripts used to convert information from other sources (e.g. /etc/passwd) into ldif files. Since it is no longer part of standard repos in Centos 8, download the copy I have provided on blackboard and extract it to /usr/share/migrationtools.</p></li><li><p>Check the content of the file directory <strong>/etc/openldap/slapd.d/cn=config/</strong> for the top branch of OpenLDAP directory configuration files:</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">schema.ldif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">config.ldif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">monitor.ldif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">-1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">frontend.ldif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">mdb.ldif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Examine the contents of olcDatabase={2}mbd.ldif:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CRC32 d9b49d55</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">hdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: olcDatabaseConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: olcMdbConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcDatabase: </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">mdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcDbDirectory: /var/lib/ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcSuffix: </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-domain,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcRootDN: </span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Manager,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-domain,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcDbIndex: objectClass eq,pres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcDbIndex: ou,cn,mail,surname,givenname eq,pres,sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">structuralObjectClass: olcMdbConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entryUUID: 5a8d299a-3f2f-1036-9244-a7abff537081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">creatorsName: </span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">createTimestamp: 20161115032843Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entryCSN: </span><span class="token number" style="color:#36acaa">20161115032843</span><span class="token plain">.258885Z</span><span class="token comment" style="color:#999988;font-style:italic">#000000#000#000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifiersName: </span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifyTimestamp: 20161115032843Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Verify that the directory for storing the OpenLDAP database (<strong>/var/lib/ldap</strong>) is owned by ldap:ldap. If this is not the case, fix it now.</li><li>Verify that the core schema file (<strong>/etc/openldap/slapd.d/cn=config/cn=schema</strong>) is also owned by ldap:ldap.</li><li>Start the ldap service (<strong>slapd</strong>), and ensure that it will automatically start when your machine boots. Check the status of the service and ensure that it started without error before continuing.</li><li>Use the ldap add command to add the cosine, nis, and inetorgperson schemata to your server <strong>in that order</strong>. Use the authentication type <strong>EXTERNAL</strong>, and <strong>ldapi:///</strong> as the host.</li><li>List the schema directory again. This time you should see the core schema, along with the three schemata you just added.</li><li>Run an ldapsearch to check that the service is running and will respond to queries:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@rns ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># ldapsearch -x -b &#x27;&#x27; -s base &#x27;(objectClass=*)&#x27; namingContexts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># extended LDIF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LDAPv3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># base &lt;&gt; with scope baseObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter: (objectClass=*)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># requesting: namingContexts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namingContexts: </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-domain,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># search result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">search: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numResponses: 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numEntries: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="12"><li>Next, you will need a password for the ldap administrator (RootDN), so that they can run commands to modify the database. Use the slappasswd command to create one, and record the output.</li><li>Insert your new password into the following ldif file, and apply it to your database with the ldapmodify command</li></ol><p><strong>Warning: Do not store your ldif files (or any other files) in the ldap configuration directory. Every file in that directory is automatically read as configuration for ldap.</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># customize domain name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">mdb,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changetype: modify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replace: olcSuffix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcSuffix: </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">mdb,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changetype: modify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replace: olcRootDN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcRootDN: </span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Manager,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">olcDatabase</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">mdb,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changetype: modify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add: olcRootPW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcRootPW: </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">SSHA</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">1Di4Suea6ojE2bFxJhLDScjQyQ97GSef</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Make note of the field that this file will modify.</li><li>As before, use the authentication type <strong>EXTERNAL</strong>, and <strong>ldapi:///</strong> as the host.</li><li>When you run the command you should get output similar to the following:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SASL/EXTERNAL authentication started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SASL username: </span><span class="token assign-left variable" style="color:#36acaa">gidNumber</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">+uidNumber</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">peercred,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">external,cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SASL SSF: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifying entry </span><span class="token string" style="color:#e3116c">&quot;olcDatabase={2}mdb,cn=config&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifying entry </span><span class="token string" style="color:#e3116c">&quot;olcDatabase={2}mdb,cn=config&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifying entry </span><span class="token string" style="color:#e3116c">&quot;olcDatabase={2}mdb,cn=config&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="14"><li>Examine the contents of your <strong>/etc/openldap/slapd.d/cn=config/olcDatabase={2}mdb.ldif</strong> file again. Your ldif file should have changed three fields. Try to identify them.</li><li>Create an LDIF file for the base context ops535.com entry to be added to the OpenLDAP directory. Name the file as base.ldif.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dc: ops535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: root LDAP entry </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ops535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: dcObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalUnit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ou: rootobject</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="16"><li>Create an LDIF file for the People container to be added to the OpenLDAP directory. Name the file as people.ldif</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People, </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535, </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ou: People</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: All people </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> ops535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalUnit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="17"><li>Apply those two ldif files to your database. This time you will need to use simple authentication, identify yourself with a distinguished name (use the ldap administrator whose password you just set), and get prompted for a password.</li><li>Before we start adding users, we need to provide the migration tools some information about our domain. Before you change anything, make a backup of the /usr/share/migrationstools/migrate_common.ph to the /root directory. Modify the following parameters in the original file to the values shown below:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$DEFAULT_MAIL_DOMAIN</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ops535.com&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$DEFAULT_BASE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dc=ops535,dc=com&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$EXTENDED_SCHEMA</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="19"><li><p>Create two new users (<strong>ldapuser1</strong> and <strong>ldapuser2</strong>) on your machine, and set their passwords. Importing those users into your ldap database will take several steps:</p><ul><li>Extract the passwd entries of ldapuser1 and ldapuser2 from /etc/passwd to a file called &quot;ldapusers.entry&quot;</li></ul></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -w ldapuser1 /etc/passwd </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /root/ldapusers.entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -w ldapuser2 /etc/passwd </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /root/ldapusers.entry</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Use the migrate_passwd.pl file to convert the user information you extracted earlier into an ldif file:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/migrationtools/migrate_passwd.pl ldapusers.entry /root/ldapusers.ldif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>This should generate an ldif file similar to the following:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ldapuser1,ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail: ldapuser1@ops535.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: posixAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: shadowAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword: </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">crypt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$6</span><span class="token variable" style="color:#36acaa">$PBqQXRo</span><span class="token plain">/ugCCjBe0.ZgvmJl8U2tVjpdR8X9bh4OZ1cl3mv4xf0Hv1HSDavkxusO8R3lI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uuJ7skrfqpTQpbZ6hbd3e3BGB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowLastChange: </span><span class="token number" style="color:#36acaa">17120</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMin: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMax: </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowWarning: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loginShell: /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homeDirectory: /home/ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ldapuser2,ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail: ldapuser2@ops535.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPersonobjectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: posixAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: shadowAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword: </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">crypt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$6</span><span class="token variable" style="color:#36acaa">$VNkVk1TQ</span><span class="token variable" style="color:#36acaa">$Rgz4GnQlqPBcHhIinUqxFGnqHZmnHHrFyCQ1ZsekoRjHnaKvb84YtjfFRPL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/xcbryrQRL5eNZeP01A3AdC2lv1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowLastChange: </span><span class="token number" style="color:#36acaa">17120</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMin: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMax: </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowWarning: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loginShell: /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uidNumber: </span><span class="token number" style="color:#36acaa">5002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gidNumber: </span><span class="token number" style="color:#36acaa">5002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homeDirectory: /home/ldapuser2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="20"><li>Use ldapadd to enter this new information into the database. As before use simple authentication, the distinguished name of the ldap administrator, and get prompted for a password.</li><li>Use ldapsearch to confirm that the new users have been added to the database. You should get output similar to the following:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># extended LDIF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LDAPv3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># base &lt;dc=ops535,dc=com&gt; with scope subtree</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter: (objectClass=*)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># requesting: ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: dcObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o: ops535 com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dc: ops535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Manager, ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">cn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Manager,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: Manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: Directory Manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># People, ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalUnit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ou: People</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ldapuser1, People, ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ldapuser1,ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail: ldapuser1@ops535.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: personobjectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: posixAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: shadowAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword:: e2NyeXB0fSQ2JFBCcVFYUm8vJHVnQ0NqQmUwLlpndm1KbDhVMnRWanBkUjhYOWJ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oNE9aMWNsM212NHhmMEh2MUhTRGF2a3h1c084UjNsSXV1Sjdza3JmcXBUUXBiWjZoYmQzZTNCR0Iu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowLastChange: </span><span class="token number" style="color:#36acaa">17120</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMin: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMax: </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowWarning: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loginShell: /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homeDirectory: /home/ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ldapuser2, People, ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ldapuser2,ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail: ldapuser2@ops535.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: posixAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: shadowAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword:: e2NyeXB0fSQ2JFZOa1ZrMVRRJFJnejRHblFscVBCY0hoSWluVXF4RkducUhabW5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ISHJGeUNRMVpzZWtvUmpIbmFLdmI4NFl0amZGUlBML3hjYnJ5clFSTDVlTlplUDAxQTNBZEMybHYx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowLastChange: </span><span class="token number" style="color:#36acaa">17120</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMin: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMax: </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowWarning: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loginShell: /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uidNumber: </span><span class="token number" style="color:#36acaa">5002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gidNumber: </span><span class="token number" style="color:#36acaa">5002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homeDirectory: /home/ldapuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># search result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">search: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numResponses: 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numEntries: 5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="22"><li>Create an ldif file called group.ldif that will add an organizational unit with the distinguished name <strong>ou=Group</strong>, <strong>dc=ops535</strong>, <strong>dc=com</strong>. It will act as an organizer for group information.</li><li>Use the /etc/group file and migrate_group.pl to create an ldif file that will add the group entries for ldapuser1 and ldapuser2 to your database.</li><li>Add the group entries for ldapuser1 and ldapuser2 to your database. Use ldapsearch to confirm that they have been added.</li><li>Modify your firewall to allow incoming ldap traffic from your internal zone. Make sure that this change persists past reboot.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-2-modifying-openldap-server-configuration-to-use-tls">Investigation 2: Modifying OpenLDAP Server Configuration to use TLS<a class="hash-link" href="#investigation-2-modifying-openldap-server-configuration-to-use-tls" title="Direct link to heading">​</a></h2><p><strong>Warning: This is a good time to make another backup of VM1.</strong></p><p>In this investigation we will modify the OpenLDAP server we just created to use TLS to encrypt the data it provides, you should notice that many of these steps are similar to the process of modifying postfix and apache servers to use TLS. Perform these steps on vm1.</p><ol><li>Install the openssl package</li><li>Run the following commands to create a self-signed TLS certificate for your server (make sure you replace the values with ones from your machine):</li></ol><p><strong>Warning: As you run these commands, read the output carefully. If you encounter any errors you must resolve them before continuing to the next command.</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out ca.key </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -x509 -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -key ca.key -out ca.cert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -out vm1.pcallagh.ops.key </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -key vm1.pcallagh.ops.key -out vm1.pcallagh.ops.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -in vm1.pcallagh.ops.csr -CA ca.cert.pem -CAkey ca.key -out vm1.pcallagh.ops.crt -CAcreateserial -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -sha256</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Copy the certificate, the private key, and the certificte authority file to an appropriate directory (make sure the directory and the files in it are owned by the ldap account and that the directory has permissions set to 0700 and the files have 0600):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> ldap.pcallagh.ops.crt ldap.pcallagh.ops.key ca.cert.pem /etc/openldap/certs/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Write an ldif file and add the following values to <strong>dn: cn=config</strong> (again making sure to put in values from your own machine):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">olcTLSCertificateFile: /etc/openldap/certs/vm1.pcallagh.ops.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcTLSCertificateKeyFile: /etc/openldap/certs/vm1.pcallagh.ops.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olcTLSCACertificateFile: /etc/openldap/certs/ca.cert.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Warning: Read the output of the ldapmodify command carefully. If you encounter any errors you must resolve them before continuing to the next command.</strong></p><ol start="5"><li>You can use slapcat to ensure they are set correctly:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">slapcat -b </span><span class="token string" style="color:#e3116c">&quot;cn=config&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">egrep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Certificate(Key)?File&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li><p>Update /etc/openldap/ldap.conf to locate your CACERT, and to indicate that ldaps is now allowed:</p><ul><li>Set the URI parameter to ldaps://vm1.&lt;yourdomain<!-- -->&gt;<!-- -->.ops. It is suggested you also include ldapi:/// so local connections are allowed.</li><li>Set TLSCACERT to the absolute path of your certificate authority file (e.g. /etc/openldap/certs/ca.cert.pem).</li><li>Set TLSCACERTDIR to the directory your certificate authority file is in (e.g. /etc/openldap/certs).</li></ul></li><li><p>Update your firewall to permanently allow ldaps instead of ldap.</p></li><li><p>Double check that you can still use ldapsearch before continuing to the next investigation.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-3-setup-and-configure-openldap-client-through-sssd">Investigation 3: Setup and Configure OpenLdap Client Through SSSD<a class="hash-link" href="#investigation-3-setup-and-configure-openldap-client-through-sssd" title="Direct link to heading">​</a></h2><p>Perform the following steps on vm2:</p><ol><li><p>Install yum-utils</p></li><li><p>Install the symas ldap repo</p></li><li><p>Install the following packages</p><ul><li>symas-openldap-clients</li><li>sssd</li><li>sssd-ldap</li><li>sssd-tools</li><li>openssl-perl</li></ul></li><li><p>If you would like to actually log into the client machines as an ldap user, you need to reconfigure the way the system authentication processes your login. To do this, you will use the authselect tool on the client machine.</p><ul><li>Note: the ldap user does not have home directory on the client unless you provide it via NFS.</li></ul></li><li><p>Copy the server&#x27;s signed certificate onto the client:</p><ul><li>openssl s_client -connect &lt;hostname or ip address of your ldap server<!-- -->&gt;<!-- -->:636 -showcerts &lt; /dev/null | openssl x509 -text &gt; /etc/openldap/certs/cacert.crt</li></ul></li><li><p>Set up the SSSD service to use ldap for authentication.</p><ul><li>Start by adding the following settings to /etc/sssd/sssd.conf</li><li>Note that you may have to create /etc/sssd/sssd.conf yourself. Make sure the file is owned by root:root and that the permissions are 0600.</li></ul></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sssd</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nss, pam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config_file_version </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domains </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sudo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">nss</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homedir_substring </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> /home</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pam</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offline_credentials_expiration </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">domain/default</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_id_use_start_tls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cache_credentials </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_search_base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">The Base DN from your ldap server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">id_provider </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_provider </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chpass_provider </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access_provider </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldaps://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token environment constant" style="color:#36acaa">HOSTNAME</span><span class="token plain"> or IP ADDRESS of your ldap server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_chpass_uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ldaps://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token environment constant" style="color:#36acaa">HOSTNAME</span><span class="token plain"> or IP ADDRESS of your ldap server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_tls_reqcert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_tls_cacert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">The absolute path of the certificate you copied over from the server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_tls_cacertdir </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">The absolute path to the directory the server&#x27;s certificate is in</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_search_timeout </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_network_timeout </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_access_order </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_access_filter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">objectClass</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">posixAccount</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Now direct sssd to use those changes by running &#x27;authselect select sssd --force&#x27;. you need the --force option to make it make changes to several files.</li><li>Test your configuration with &#x27;sssctl config-check&#x27; and fix any errors it identifies</li><li>Once your configuration passes the sssctl check, start and enable sssd.</li></ul><ol start="7"><li>Test that your machine is connected to the ldap server by searching for the ldapuser 1 account:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">id</span><span class="token plain"> ldapuser1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>You should get something similar to the following (but may not be exactly the same):</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1002</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ldapuser1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">gid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1002</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ldapuser1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">groups</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1002</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ldapuser1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="8"><li><p>If you want to be able to use commands like ldapsearch from this machine, you will also need to configure ldap in /etc/openldap/ldap.conf. This configuration file should already exist, you just need to modify the parameters to identify the LDAP server and location of its certificate.</p><ul><li>BASE &lt;base DC from your ldap server<!-- -->&gt;</li><li>URI ldaps://&lt;hostname or ip address of your ldap server<!-- -->&gt;</li><li>TLS_CACERT &lt;the absolute path of the certificate you downloaded from the server earlier.<!-- -->&gt;</li><li>TLS_CACERTDIR &lt;the directory you saved the certificate in<!-- -->&gt;</li></ul></li><li><p>Test your OpenLDAP client with the ldapsearch command.</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldapsearch -x </span><span class="token string" style="color:#e3116c">&#x27;uid=ldapuser1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>You should get results similar to the following:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># extended LDIF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LDAPv3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># base &lt;dc=ops535,dc=com&gt; (default) with scope subtree</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># filter: uid=ldapuser1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># requesting: ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ldapuser1, People, ops535.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dn: </span><span class="token assign-left variable" style="color:#36acaa">uid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ldapuser1,ou</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">People,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ops535,dc</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uid: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sn: ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail: ldapuser1@ops535.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: organizationalPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: inetOrgPerson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: posixAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objectClass: shadowAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userPassword:: e2NyeXB0fSQ2JFBCcVFYUm8vJHVnQ0NqQmUwLlpndm1KbDhVMnRWanBkUjhYOWJ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oNE9aMWNsM212NHhmMEh2MUhTRGF2a3h1c084UjNsSXV1Sjdza3JmcXBUUXBiWjZoYmQzZTNCR0Iu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowLastChange: </span><span class="token number" style="color:#36acaa">17120</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMin: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowMax: </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shadowWarning: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loginShell: /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gidNumber: </span><span class="token number" style="color:#36acaa">5001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homeDirectory: /home/ldapuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># search resultsearch: 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numResponses: 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># numEntries: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>Logout of the client machine, then log back in using the ldapuser1 account.</li><li>Repeat steps 1 through 7 on vm3.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-4-update-ldap-configuration">Investigation 4: Update LDAP Configuration<a class="hash-link" href="#investigation-4-update-ldap-configuration" title="Direct link to heading">​</a></h2><ol><li><p>Add the following user accounts to your LDAP server:</p><ul><li>user name: your seneca id – password: pick your own</li><li>rchan – password: ops535</li><li>seneca – password: ops535</li></ul></li><li><p>Run the ldapsearch command for each user, and confirm that their information is correct</p></li><li><p>Consult the man page on ldappasswd to find out how to change an LDAP user&#x27;s password. Change seneca&#x27;s password to seneca.</p></li><li><p>Consult the man page on ldapdelete to find out how to remove an LDAP user. Delete ldapuser2.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="completing-the-lab">Completing the Lab<a class="hash-link" href="#completing-the-lab" title="Direct link to heading">​</a></h2><p>You should now have a server providing centralized management of your user information. A service like this will make it much easier to manage and maintain users in your network. When combined with a service like NFS, this centralizes user management and make it much easier to scale your network up.</p><p>Follow the instructions on blackboard to submit the lab.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploration-questions">Exploration Questions<a class="hash-link" href="#exploration-questions" title="Direct link to heading">​</a></h2><ol><li>What changes would you make in NFS to provide remote access to home directories?</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OERTemplate/tree/main/docs/A-Labs/lab3-stage1.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OPS535/A-Labs/lab2-stage2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 2 Part 2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OPS535/A-Labs/lab3-stage2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 3 Part 2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#purpose" class="table-of-contents__link toc-highlight">Purpose</a></li><li><a href="#pre-requisites" class="table-of-contents__link toc-highlight">Pre-Requisites</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li><li><a href="#investigation-1-openldap-server-setup-and-configuration" class="table-of-contents__link toc-highlight">Investigation 1: OpenLDAP Server Setup and Configuration</a></li><li><a href="#investigation-2-modifying-openldap-server-configuration-to-use-tls" class="table-of-contents__link toc-highlight">Investigation 2: Modifying OpenLDAP Server Configuration to use TLS</a></li><li><a href="#investigation-3-setup-and-configure-openldap-client-through-sssd" class="table-of-contents__link toc-highlight">Investigation 3: Setup and Configure OpenLdap Client Through SSSD</a></li><li><a href="#investigation-4-update-ldap-configuration" class="table-of-contents__link toc-highlight">Investigation 4: Update LDAP Configuration</a></li><li><a href="#completing-the-lab" class="table-of-contents__link toc-highlight">Completing the Lab</a></li><li><a href="#exploration-questions" class="table-of-contents__link toc-highlight">Exploration Questions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OPS535 Course Title</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OPS535/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OPS535/assets/js/runtime~main.234e0372.js"></script>
<script src="/OPS535/assets/js/main.43f4e331.js"></script>
</body>
</html>