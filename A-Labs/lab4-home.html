<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab4-home">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OPS535/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OPS535/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OPS535/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OPS535/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OPS535/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 4 | OPS535 Course Title</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab4-home"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 4 | OPS535 Course Title"><meta data-rh="true" name="description" content="Lab 4"><meta data-rh="true" property="og:description" content="Lab 4"><link data-rh="true" rel="icon" href="/OPS535/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab4-home"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab4-home" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/A-Labs/lab4-home" hreflang="x-default"><link rel="stylesheet" href="/OPS535/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OPS535/assets/js/runtime~main.55e5135c.js" as="script">
<link rel="preload" href="/OPS535/assets/js/main.43f4e331.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OPS535/"><div class="navbar__logo"><img src="/OPS535/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OPS535/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OPS535 Course Title</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/">Welcome to OPS535</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OPS535/A-Labs/prelab0">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/prelab0">Pre Lab 0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab1-alt">Lab 1 Alternate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab2-stage1">Lab 2 Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab2-stage2">Lab 2 Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab3-stage1">Lab 3 Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab3-stage2">Lab 3 Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OPS535/A-Labs/lab4-home">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab4-vl">Lab 4 Alternate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/C-ExtraResources/required-material-list">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OPS535/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 4</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 4 - At Home</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="purpose">Purpose<a class="hash-link" href="#purpose" title="Direct link to heading">​</a></h2><p>In this lab, you are going to build a primary name server for your assigned DNS domain using the BIND package on your VM1. A primary name server does not depend upon having access to other name servers in order to function. Once you have your primary name server running for your forward and reverse zones, you will use command line DNS client tool(s) to test the correctness of the query responses from your Primary DNS server. Then you will configure both zones to support dynamic updates. Dynamic DNS accepts updates from the command line utility “nsupdate”. This lab does not configure the DNS server to use secure channel for the updates.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-requisites">Pre-Requisites<a class="hash-link" href="#pre-requisites" title="Direct link to heading">​</a></h2><p>The pre-lab must be complete so that your virtual machines share access to a private network. Lab 1 must also be complete so that your machines have access to a network that will provide them access to the outside world (e.g. to install packages).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-1-primary-name-server">Investigation 1: Primary Name Server<a class="hash-link" href="#investigation-1-primary-name-server" title="Direct link to heading">​</a></h2><ol><li>Use the skills you learned in previous courses to make your vm1 act as the primary name server for your assigned domain.<ul><li>The SOA record should contain the FQDN of your primary DNS server and the email address of the person responsible for managing your DNS domain name space.</li><li>The NS record(s) should contain the FQDN for your authoritative DNS server(s).</li><li>Each A record (address record) should contain the FQDN (or host name) of each VM and its corresponding IP address.</li><li>Each PTR record should contain the FQDN and the corresponding IP address in reverse dotted-decimal notation format (e.g. use 53.99.168.192.in-addr.arpa. for IP address 192.168.99.53)</li><li>The file for your forward zone should be my-zone.txt, and the file for the reverse zone should be rev-zone.txt.</li><li>Make sure you configure the following major options:<ul><li>listen-on: port 53 and all network interface</li><li>directory: /var/named</li><li>allow-query: any</li><li>recursion: yes, but only for your machines and the recursive query should be sent to your host machine.</li><li>dnssec-enable: yes</li><li>dnssec-validation: no</li><li>dnssec-lookaside: auto</li></ul></li><li>Ensure you service is running, will continue to run past boot, and is accessible by the other machines in your network.</li></ul></li><li>Modify your other lab VMs so that they use your VM1 as the first DNS server to contact, and your host as the second (in case your VM1 fails).</li><li>Run the appropriate &quot;tcpdump&quot; command on your DNS server to capture all DNS query and response packets to a file named <strong>dns-packet</strong> in the /root directory. While tcpdump is running on your DNS server, repeat <strong>all</strong> the DNS queries (SOA, NS, A, PTR) on your host.<ul><li>Read the tcpdump file with the &quot;-r&quot; flag to verify that the targeted packets were captured to the file. It should contain queries and answers for each of the records in your domain.</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-2-dynamic-dns-updates">Investigation 2: Dynamic DNS Updates<a class="hash-link" href="#investigation-2-dynamic-dns-updates" title="Direct link to heading">​</a></h2><p>Perform the following steps on vm1 after you have confirmed that it is providing correct forward and reverse lookups of all machines in your domain.</p><ol><li>Add the following line to your forward and reverse zone entries</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">allow-update </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> localhost</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><p>Verify the user owner, group owner, permissions, and SELinux contexts of your zone files:</p><ul><li>The user and group ownership should be set to named.</li><li>The user account for named must be able to write to both files.</li><li>The user account for named must be able to write to /var/named.</li><li>The SELinux context type for both zone files should be “named_zone_t”. If it is not, you can fix it with the command “chcon -t named_zone_t &lt;file<!-- -->&gt;<!-- -->”.</li><li>The SELinux boolean that allows named to write to the /var/named directory (<strong>named_write_master_zones</strong>) must be set to <strong>on</strong>.</li><li>Note that in recent releases/updates of Centos these SELinux settings have become the default, so you should not have to change them, but this may not be the case if you are ever working on an older system.</li></ul></li><li><p>Restart named. If it does not complain, continue to the next step, otherwise check the system log file <strong>/var/log/messages</strong> for error messages. In addition to the debugging messages you may find in the system log file, you can also use the two utilities <strong>named-checkconf</strong> and <strong>named-checkzone</strong> to check for typos or syntax errors in named.conf or your zone files. Please consult the man page for <strong>named-checkconf</strong> and <strong>named-checkzone</strong> for details.</p></li><li><p>Perform a dynamic update using nsupdate: Run the following command(s) on your primary DNS server in order to dynamically add a new A record. Note that you will have to fill in information for your own domain.</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost named</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># nsupdate -d</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> server </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> update </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> c7host.pcallagh.ops </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> A </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.182.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> send</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reply from SOA query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: QUERY, status: NXDOMAIN, id: </span><span class="token number" style="color:#36acaa">42401</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags: qr aa</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> QUESTION: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ANSWER: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, AUTHORITY: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> QUESTION SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">c7host.pcallagh.ops. IN SOA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> AUTHORITY SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddns.net. </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> IN SOA vm1.pcallagh.ops. root.pcallagh.ops. </span><span class="token number" style="color:#36acaa">20151111</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">900</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">259200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found zone name: ddns.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The master is: vm1.pcallagh.ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sending update to </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><span class="token comment" style="color:#999988;font-style:italic">#53</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Outgoing update query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: UPDATE, status: NOERROR, id: </span><span class="token number" style="color:#36acaa">25883</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags:</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, PREREQ: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, UPDATE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> UPDATE SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c7host.pcallagh.ops. </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> IN A </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.99.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reply from update query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: UPDATE, status: NOERROR, id: </span><span class="token number" style="color:#36acaa">25883</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags: qr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, PREREQ: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, UPDATE: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddns.net. IN SOA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The above “Reply from update query” section indicates that the update was successful with a “NOERROR” status.</li><li>All changes made to a zone using dynamic update are stored in the zone&#x27;s journal file. In this case, the file will be in the /var/named directory and is called “&lt;zonefile<!-- -->&gt;<!-- -->.jnl”. Assuming the permissions and SELinux settings are correct, this file is automatically created by the DNS server when the first dynamic update is received. Please note that the name of the journal file is formed by appending the extension “.jnl” to the name of the corresponding zone file. The journal file is in a binary format and can not be edited using a text editor.</li><li>The server will occasionally write the updates found in the journal file to its zone file or when a server is restarted after a shutdown.</li><li>Examine your /var/named directory to make sure the journal file got created. Use the <strong>file</strong> command to check the content type.</li><li>Although you will not be able to view the contents of this file using tools like <strong>cat</strong>, the <strong>named-journalprint</strong> command from the <strong>bind</strong> package can be used to print the contents of journal files. Run it and you should see output similar to the following (though again, with details from your own domain):</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost named</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># named-journalprint my-zone.txt.jnl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">del pcallagh.ops. </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> IN SOA vm1.pcallagh.ops. root.pcallagh.ops. </span><span class="token number" style="color:#36acaa">20151111</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">900</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">259200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> ddns.net. </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> IN SOA vm1.pcallagh.ops. root.pcallagh.ops. </span><span class="token number" style="color:#36acaa">20151112</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">900</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">259200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> c7host.pcallagh.ops. </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> IN A </span><span class="token number" style="color:#36acaa">172.16</span><span class="token plain">.182.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Use the nsupdate command to add an incorrect record to your zone (e.g. add a PTR record giving your host the wrong address, using a final octet of 100 instead of 1). Query your server to double check that the mistaken record has been added.</li><li>Use nsupdate to delete a record from your zones. Inevitably, you will need to delete information from a zone at some point. In the previous step, we deliberately added incorrect information in order to delete it in this step. If you do not have an incorrect record, go back and add one before continuing. First we will try to delete a record that doesn’t exist.:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root@localhost named</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># nsupdate -d</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> server </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> update delete </span><span class="token number" style="color:#36acaa">10.182</span><span class="token plain">.16.172.in-addr.arpa.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> send</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reply from SOA query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: QUERY, status: NXDOMAIN, id: </span><span class="token number" style="color:#36acaa">17329</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags: qr aa</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> QUESTION: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ANSWER: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, AUTHORITY: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> QUESTION SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10.182</span><span class="token plain">.16.172.in-addr.arpa. IN SOA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> AUTHORITY SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">16.172</span><span class="token plain">.in-addr.arpa. </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> IN SOA vm1.pcallagh.ops. root.pcallagh.ops. </span><span class="token number" style="color:#36acaa">20151112</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">900</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">259200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found zone name: </span><span class="token number" style="color:#36acaa">16.172</span><span class="token plain">.in-addr.arpa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The master is: vm1.pcallagh.ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sending update to </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><span class="token comment" style="color:#999988;font-style:italic">#53</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Outgoing update query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: UPDATE, status: NOERROR, id: </span><span class="token number" style="color:#36acaa">44360</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags:</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, PREREQ: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, UPDATE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> UPDATE SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10.182</span><span class="token plain">.16.172.in-addr.arpa. </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> ANY ANY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reply from update query:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> opcode: UPDATE, status: NOERROR, id: </span><span class="token number" style="color:#36acaa">44360</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> flags: qr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, PREREQ: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, UPDATE: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, ADDITIONAL: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ZONE SECTION:16.172.in-addr.arpa. IN SOA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Notice that there is no complaint from the server when trying to delete a record that doesn&#x27;t exist. Examine your journal file to see if it recorded the attempt.</li><li>Now use <strong>nsupdate</strong> to delete the bad record from the earlier step, then examine your journal file to see if it did get deleted.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="completing-the-lab">Completing the Lab<a class="hash-link" href="#completing-the-lab" title="Direct link to heading">​</a></h2><p>You should now have a server providing DNS services for your network. Many other services, and most of your users, will depend on this for translation between hostnames and addresses. You have also configured the service to allow for dynamic updates, though they are limited to the local machine only. In the extension to this lab you may continue this configuration to allow such updates to be made from another machine, though this will require some extra security setup to ensure that only approved machines may make such updates.</p><p>You should be able to interpret journal files in order to understand the changes that are being made to a zone.</p><p>Follow the instructions on blackboard to submit the lab.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploration-questions">Exploration Questions<a class="hash-link" href="#exploration-questions" title="Direct link to heading">​</a></h2><ol><li>Which rpm package provides the “nsupdate” command line utility?</li><li>What does the “-d” option do for the “nsupdate” command?</li><li>Which RFC document defines the Dynamic DNS update protocol?</li><li>Could nsupdate send a dynamic DNS update to a DNS server using a non-standard port? (port 53 is DNS standard port number.)</li><li>What are the steps using nsupdate to add an “A” record for a host with FQDN “linux.ddns.net” IP address 172.16.101.90 with a TTL of 60 seconds?</li><li>What are the steps using nsupdate to add a &#x27;PTR” record for the host in question 5?</li><li>What are the steps using nsupdate to add a “CNAME” record for “gnu.ddns.net” that points to “linux.ddns.net”?</li><li>What are the steps using nsupdate to delete the “A” record created in question 5?</li><li>What are the steps using nsupdate to delete the “PTR” record created in question 6?</li><li>What are the steps using nsupdate to delete the “CNAME” record created in question 7?</li><li>What would happen if you try to delete a non-existence resource record (PTR, A, CNAME, MX, etc) from a dynamic DNS zone using nsupdate?</li><li>What would happen if you try to add a duplicate resource record to a dynamic zone using nsupdate?</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OERTemplate/tree/main/docs/A-Labs/lab4-home.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OPS535/A-Labs/lab3-stage2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 3 Part 2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OPS535/A-Labs/lab4-vl"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 4 Alternate</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li><li><a href="#purpose" class="table-of-contents__link toc-highlight">Purpose</a></li><li><a href="#pre-requisites" class="table-of-contents__link toc-highlight">Pre-Requisites</a></li><li><a href="#investigation-1-primary-name-server" class="table-of-contents__link toc-highlight">Investigation 1: Primary Name Server</a></li><li><a href="#investigation-2-dynamic-dns-updates" class="table-of-contents__link toc-highlight">Investigation 2: Dynamic DNS Updates</a></li><li><a href="#completing-the-lab" class="table-of-contents__link toc-highlight">Completing the Lab</a></li><li><a href="#exploration-questions" class="table-of-contents__link toc-highlight">Exploration Questions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OPS535 Course Title</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OPS535/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OPS535/assets/js/runtime~main.55e5135c.js"></script>
<script src="/OPS535/assets/js/main.43f4e331.js"></script>
</body>
</html>