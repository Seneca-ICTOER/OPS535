<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-C-ExtraResources/vls2vls-routing">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OPS535/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OPS535/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OPS535/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OPS535/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OPS535/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">VLS2VLS Routing | OPS535 - Open System Clustering - Advanced Network Administration</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OPS535/C-ExtraResources/vls2vls-routing"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="VLS2VLS Routing | OPS535 - Open System Clustering - Advanced Network Administration"><meta data-rh="true" name="description" content="VLS2VLS Routing"><meta data-rh="true" property="og:description" content="VLS2VLS Routing"><link data-rh="true" rel="icon" href="/OPS535/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OPS535/C-ExtraResources/vls2vls-routing"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/C-ExtraResources/vls2vls-routing" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS535/C-ExtraResources/vls2vls-routing" hreflang="x-default"><link rel="stylesheet" href="/OPS535/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OPS535/assets/js/runtime~main.326f425b.js" as="script">
<link rel="preload" href="/OPS535/assets/js/main.fc9f60ba.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OPS535/"><div class="navbar__logo"><img src="/OPS535/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OPS535/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OPS535 - Open System Clustering - Advanced Network Administration</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/">Welcome to OPS535</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS535/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/A-Labs/prelab0">Labs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OPS535/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OPS535/C-ExtraResources/required-material-list">Extra Resources</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/required-material-list">Required Material List</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/due-dates">Assignments, Lab due dates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/prerequisite-review">Single Host Administration Review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/linux-firewall-review">Firewalls Review and configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/tcp-ip-network-review">TCP/IP Network Review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/local-and-network-security">Local and Network Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/network-storage-and-access">Network Storage and Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/network-file-system">NFS - Network File System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/openldap-server-admin">OpenLDAP Server Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/ldap-protocol">LDAP Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/dns-review">DNS Review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/advanced-dns">Advanced DNS - DNS Logging, Dynamics DNS, and DNSSEC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/advanced-dns-topics">Advanced DNS Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/email-protocols">eMail Protocol suite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/email-protocols-2">SMTP, POP, and IMAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/postfix-spf">Sender Policy Framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/internet-mail-system">DNS and eMail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/sample-ansible-hosts">Sample Ansible Hosts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/ansible-setup">Ansible Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OPS535/C-ExtraResources/vls2vls-routing">VLS2VLS Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/startup-script-with-systemd">Startup script with systemd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/virtual-lan">Virtual-Lan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/Get Device Name">Get Device Name</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/network-address">Network Address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/get-root-zone">Get Root Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/domainreg">Domainreg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS535/C-ExtraResources/bind-configuration">Bind Configuration</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OPS535/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Extra Resources</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">VLS2VLS Routing</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>VLS2VLS Routing</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="background-information">Background Information<a class="hash-link" href="#background-information" title="Direct link to heading">​</a></h2><p>The following configuration may be used to set up the proper routes between private Virtual LAN Segments (VLS) in OPS535 Virtual Lab on CentOS 8.x virtual machines. The custom routes added to the gateway VM (VM1), and their corresponding VMs (VM2 to VM4) in their private VLS will enable VMs in each private VLS to communicate with VMs in the other private VLS.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-lan-segment-setting">Virtual LAN Segment setting<a class="hash-link" href="#virtual-lan-segment-setting" title="Direct link to heading">​</a></h2><p>Consider three VLSs (one for each student) where there are 3 gateways, one for each VLS in the OPS535 virtual lab:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vls-1">VLS 1<a class="hash-link" href="#vls-1" title="Direct link to heading">​</a></h2><p>VLS network: 192.168.1.0/24</p><p>Gateway (Host) IPs: Internal (ens224): 192.168.1.1 External (ens192): 172.20.1.1</p><p>VMs IPs:</p><ul><li>VM2: 192.168.1.2</li><li>VM3: 192.168.1.3</li><li>VM4: 192.168.1.4</li></ul><p>Default gateway on each VM2: 172.20.255.1 Gateway to the 192.168.0.0/16 network: 192.168.1.1</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vls-2">VLS 2<a class="hash-link" href="#vls-2" title="Direct link to heading">​</a></h2><p>VLS network: 192.168.2.0/24</p><p>Gateway (Host) IPs: Internal (ens224): 192.168.2.1 External (ens192): 172.20.2.1</p><p>VMs IPs:</p><ul><li>VM2: 192.168.2.2</li><li>VM3: 192.168.2.3</li><li>VM4: 192.168.2.4</li></ul><p>Default gateway on each VM2: 172.20.255.1 Gateway to the 192.168.0.0/16 network: 192.168.2.1</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vls-3">VLS 3<a class="hash-link" href="#vls-3" title="Direct link to heading">​</a></h2><p>VLS network: 192.168.3.0/24</p><p>Gateway (Host) IPs: Internal (ens224): 192.168.3.1 External (ens192): 172.20.3.1</p><p>VMs IPs:</p><ul><li>VM2: 192.168.3.2</li><li>VM3: 192.168.3.3</li><li>VM4: 192.168.3.4</li></ul><p>Default gateway on each VM2: 172.20.255.1 Gateway to the 192.168.0.0/16 network: 192.168.3.1</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="manually-configure-custom-routes-on-the-gateways-to-reach-vms-in-other-vlss">Manually configure custom routes on the gateways to reach VMs in other VLSs<a class="hash-link" href="#manually-configure-custom-routes-on-the-gateways-to-reach-vms-in-other-vlss" title="Direct link to heading">​</a></h2><p>You only need to create the custom routes on your own VLS, but make sure that other student&#x27;s VLS has the custom routes to your VLS.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="on-vls-1">On VLS 1<a class="hash-link" href="#on-vls-1" title="Direct link to heading">​</a></h3><p>On VLS 1&#x27;s gateway (192.168.1.1 or 172.20.1.1): Using nmcli:</p><ul><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.2.0/24 172.20.2.1 100&quot;</li><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.3.0/24 172.20.3.1 100&quot;</li><li>nmcli con down ens192</li><li>nmcli con up ens192</li></ul><p>Check to make sure that your kernel routing table has the proper entries with the following command:</p><ul><li>ip route show</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="on-vls-2">On VLS 2<a class="hash-link" href="#on-vls-2" title="Direct link to heading">​</a></h3><p>On VLS 2&#x27;s gateway (192.168.2.1 or 172.20.2.1): Using nmcli:</p><ul><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.1.0/24 172.20.1.1 100&quot;</li><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.3.0/24 172.20.3.1 100&quot;</li><li>nmcli con down ens192</li><li>nmcli con up ens192</li></ul><p>Check to make sure that your kernel routing table has the proper entries with the following command:</p><ul><li>ip route show</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="on-vls-3">On VLS 3<a class="hash-link" href="#on-vls-3" title="Direct link to heading">​</a></h3><p>On VLS 3&#x27;s gateway (192.168.3.1 or 172.20.3.1): Using nmcli:</p><ul><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.1.0/24 172.20.1.1 100&quot;</li><li>nmcli con modify ens192 +ipv4.routes &quot;192.168.2.0/24 172.20.2.1 100&quot;</li><li>nmcli con down ens192</li><li>nmcli con up ens192</li></ul><p>Check to make sure that your kernel routing table has the proper entries with the following command:</p><ul><li>ip route show</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="manually-configure-routes-on-each-vm-in-each-vls">Manually Configure routes on each VM in each VLS<a class="hash-link" href="#manually-configure-routes-on-each-vm-in-each-vls" title="Direct link to heading">​</a></h2><p>You only need to create the custom routes on the VM in your VLS, but make sure that other students have proper routes on their VMs as well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vls-1-vm2-to-vm4">VLS 1 VM2 to VM4<a class="hash-link" href="#vls-1-vm2-to-vm4" title="Direct link to heading">​</a></h3><p>On VLS 1&#x27;s VM (192.168.1.2 .. 192.168.1.4)</p><ul><li>nmcli con modify ens224 +ipv4.routes &quot;192.168.0.0/16 192.168.1.1 100&quot;</li><li>nmcli con down ens224</li><li>nmcli con up ens224</li><li>ip route show</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vls-2-vm2-to-vm4">VLS 2 VM2 to VM4<a class="hash-link" href="#vls-2-vm2-to-vm4" title="Direct link to heading">​</a></h3><p>On VLS 2&#x27;s VM (192.168.2.2 .. 192.168.2.4)</p><ul><li>nmcli con modify ens224 +ipv4.routes &quot;192.168.0.0/16 192.168.2.1 100&quot;</li><li>nmcli con down ens224</li><li>nmcli con up ens224</li><li>ip route show</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vls-3-vm2-to-vm4">VLS 3 VM2 to VM4<a class="hash-link" href="#vls-3-vm2-to-vm4" title="Direct link to heading">​</a></h3><p>On VLS 3&#x27;s VM (192.168.3.2 .. 192.168.3.4)</p><ul><li>nmcli con modify ens224 +ipv4.routes &quot;192.168.0.0/16 192.168.3.1 100&quot;</li><li>nmcli con down ens224</li><li>nmcli con up ens224</li><li>ip route show</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="automate-the-process-using-bash-script">Automate the process using BASH script<a class="hash-link" href="#automate-the-process-using-bash-script" title="Direct link to heading">​</a></h2><p>The above example shows that 2 custom routes on each VLS are needed to provides the proper routing to reach 2 other VLS on the your gateway (VM1). It will be quite time consuming to manage all the routes if the number of VLS is much greater (how about 40 VLSs?). The following script will be more practical if your need to set up all the necessary routes for a large number of VLSs. Both scripts use the shell environment variables &quot;MY<!-- -->_<!-- -->VLS<!-- -->_<!-- -->NO&quot; and &quot;OTHER<!-- -->_<!-- -->VLS<!-- -->_<!-- -->NOS&quot; to allow customization for different values of VLSs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="shell-script-for-adding-custom-routes-on-your-gateway-to-others-vlss">Shell Script for adding custom routes on your gateway to other&#x27;s VLSs<a class="hash-link" href="#shell-script-for-adding-custom-routes-on-your-gateway-to-others-vlss" title="Direct link to heading">​</a></h2><ul><li>set the shell variable MY<!-- -->_<!-- -->VLS<!-- -->_<!-- -->NO to your assigned network ID (I use 2 here as an example, please change 2 to your assigned network ID)</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">MY_VLS_NO</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>edit the shell variable OTHER<!-- -->_<!-- -->VLS<!-- -->_<!-- -->NOS to the list of VLS you want to have a route to their VLS network. The following example assign the list of network numbers 1 to 43 that you want to create a custom route on your gateway.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token assign-left variable" style="color:#36acaa">OTHER_VLS_NOS</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">seq</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">1</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">43</span><span class="token variable" style="color:#36acaa">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following Bash script to add 42 new custom routes to your gateway VM&#x27;s routing table:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#! /bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> -z </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$MY_VLS_NO</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Please run the following command to assign your network number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;to the shell varible MY_VLS_NO and run this script again.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Please replace xx with your actual network number.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;  export MY_VLS_NO=xx&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">X</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${MY_VLS_NO}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Your Network Number is </span><span class="token string variable" style="color:#36acaa">$X</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># change the following variable if necessary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">OTHER_VLS_NOS</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">seq</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">1</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">43</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">Y</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">echo</span><span class="token variable" style="color:#36acaa"> $</span><span class="token variable punctuation" style="color:#393A34">{</span><span class="token variable" style="color:#36acaa">OTHER_VLS_NOS</span><span class="token variable punctuation" style="color:#393A34">}</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Route to be added for the network number(s) </span><span class="token string variable" style="color:#36acaa">$Y</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> -n </span><span class="token string" style="color:#e3116c">&quot;Press ENTER to continue ... &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">read</span><span class="token plain"> dummy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add new route</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">y</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$Y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$X</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -ne </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$y</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nmcli con modify ens192 +ipv4.routes </span><span class="token string" style="color:#e3116c">&quot;192.168.</span><span class="token string variable" style="color:#36acaa">${y}</span><span class="token string" style="color:#e3116c">.0/24 172.20.</span><span class="token string variable" style="color:#36acaa">${y}</span><span class="token string" style="color:#e3116c">.1 100&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Adding route to 192.168.</span><span class="token string variable" style="color:#36acaa">${y}</span><span class="token string" style="color:#e3116c">.0 network.&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nmcli con down ens192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nmcli con up ens192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> route show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># enable IP forwarding on the gateway, add &quot;net.ipv4.ip_forward = 1&quot; to /etc/sysctl.conf </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /proc/sys/net/ipv4/ip_forward</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OERTemplate/tree/main/docs/C-ExtraResources/vls2vls-routing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OPS535/C-ExtraResources/ansible-setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ansible Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OPS535/C-ExtraResources/startup-script-with-systemd"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Startup script with systemd</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background-information" class="table-of-contents__link toc-highlight">Background Information</a></li><li><a href="#virtual-lan-segment-setting" class="table-of-contents__link toc-highlight">Virtual LAN Segment setting</a></li><li><a href="#vls-1" class="table-of-contents__link toc-highlight">VLS 1</a></li><li><a href="#vls-2" class="table-of-contents__link toc-highlight">VLS 2</a></li><li><a href="#vls-3" class="table-of-contents__link toc-highlight">VLS 3</a></li><li><a href="#manually-configure-custom-routes-on-the-gateways-to-reach-vms-in-other-vlss" class="table-of-contents__link toc-highlight">Manually configure custom routes on the gateways to reach VMs in other VLSs</a><ul><li><a href="#on-vls-1" class="table-of-contents__link toc-highlight">On VLS 1</a></li><li><a href="#on-vls-2" class="table-of-contents__link toc-highlight">On VLS 2</a></li><li><a href="#on-vls-3" class="table-of-contents__link toc-highlight">On VLS 3</a></li></ul></li><li><a href="#manually-configure-routes-on-each-vm-in-each-vls" class="table-of-contents__link toc-highlight">Manually Configure routes on each VM in each VLS</a><ul><li><a href="#vls-1-vm2-to-vm4" class="table-of-contents__link toc-highlight">VLS 1 VM2 to VM4</a></li><li><a href="#vls-2-vm2-to-vm4" class="table-of-contents__link toc-highlight">VLS 2 VM2 to VM4</a></li><li><a href="#vls-3-vm2-to-vm4" class="table-of-contents__link toc-highlight">VLS 3 VM2 to VM4</a></li></ul></li><li><a href="#automate-the-process-using-bash-script" class="table-of-contents__link toc-highlight">Automate the process using BASH script</a></li><li><a href="#shell-script-for-adding-custom-routes-on-your-gateway-to-others-vlss" class="table-of-contents__link toc-highlight">Shell Script for adding custom routes on your gateway to other&#39;s VLSs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OPS535 - Open System Clustering - Advanced Network Administration</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OPS535/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OPS535/assets/js/runtime~main.326f425b.js"></script>
<script src="/OPS535/assets/js/main.fc9f60ba.js"></script>
</body>
</html>