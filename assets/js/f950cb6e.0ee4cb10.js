"use strict";(self.webpackChunkOPS535=self.webpackChunkOPS535||[]).push([[5613],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),s=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(n),h=r,k=d["".concat(u,".").concat(h)]||d[h]||c[h]||o;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6931:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return c},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return s}});var a=n(3117),r=(n(7294),n(3905));const o={id:"virtual-lan",title:"Virtual-Lan",sidebar_position:21,description:"Virtual-Lan"},l="Virtual-Lan",i={unversionedId:"C-ExtraResources/virtual-lan",id:"C-ExtraResources/virtual-lan",title:"Virtual-Lan",description:"Virtual-Lan",source:"@site/docs/C-ExtraResources/virtual-lan.md",sourceDirName:"C-ExtraResources",slug:"/C-ExtraResources/virtual-lan",permalink:"/OPS535/C-ExtraResources/virtual-lan",draft:!1,editUrl:"https://github.com/Seneca-ICTOER/OERTemplate/tree/main/docs/C-ExtraResources/virtual-lan.md",tags:[],version:"current",sidebarPosition:21,frontMatter:{id:"virtual-lan",title:"Virtual-Lan",sidebar_position:21,description:"Virtual-Lan"},sidebar:"courseNotesSidebar",previous:{title:"Startup script with systemd",permalink:"/OPS535/C-ExtraResources/startup-script-with-systemd"},next:{title:"Get Device Name",permalink:"/OPS535/C-ExtraResources/Get Device Name"}},u={},s=[{value:"Setup a Virtual Local Area Network environment for OPS535 Labs",id:"setup-a-virtual-local-area-network-environment-for-ops535-labs",level:2},{value:"OS Installation",id:"os-installation",level:3},{value:"Virtual Network Configuration",id:"virtual-network-configuration",level:3},{value:"Private Network Address Allocation",id:"private-network-address-allocation",level:3},{value:"CentOS Installation and update Issues",id:"centos-installation-and-update-issues",level:2},{value:"My Questions",id:"my-questions",level:2},{value:"Checks the following setup",id:"checks-the-following-setup",level:3}],p={toc:s};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"virtual-lan"},"Virtual-Lan"),(0,r.kt)("h2",{id:"setup-a-virtual-local-area-network-environment-for-ops535-labs"},"Setup a Virtual Local Area Network environment for OPS535 Labs"),(0,r.kt)("h3",{id:"os-installation"},"OS Installation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Install 64-bit version of CentOS 7 with Virtualization Packages on the Host Computer (the physical unit)"),(0,r.kt)("li",{parentName:"ul"},"Create Four Virtual Machines, each with 10GB of disk space, 1G Memory, 1CPU"),(0,r.kt)("li",{parentName:"ul"},"Install CentOS 7 (excluding Virutualization Packages) on VM1 to VM3 with at least the following packages:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"NFS"),(0,r.kt)("li",{parentName:"ul"},"NIS"),(0,r.kt)("li",{parentName:"ul"},"DNS"),(0,r.kt)("li",{parentName:"ul"},"DHCP"),(0,r.kt)("li",{parentName:"ul"},"Postfix,"),(0,r.kt)("li",{parentName:"ul"},"OpenLDAP"),(0,r.kt)("li",{parentName:"ul"},"Wireshark"),(0,r.kt)("li",{parentName:"ul"},"tcpdump"))),(0,r.kt)("li",{parentName:"ul"},"CentOS 7 configuration:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Enable iptables"),(0,r.kt)("li",{parentName:"ul"},"Create a regular user account using your Seneca email ID"),(0,r.kt)("li",{parentName:"ul"},"Enable SELinux"))),(0,r.kt)("li",{parentName:"ul"},"Collect the following information:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"IP address(es) assigned to the host OS and each VM for the virtual network"),(0,r.kt)("li",{parentName:"ul"},"Name of the network device used by the host OS to connect to the virtual network"),(0,r.kt)("li",{parentName:"ul"},"IP address, netmask, and gateway for each guest OS"),(0,r.kt)("li",{parentName:"ul"},"Name of the device used by each guest OS to connect to the virtual network"))),(0,r.kt)("li",{parentName:"ul"},"Install Fedora 21 (without Virtualization packages) on VM4 with the following packages:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"NFS"),(0,r.kt)("li",{parentName:"ul"},"NIS"),(0,r.kt)("li",{parentName:"ul"},"DNS"),(0,r.kt)("li",{parentName:"ul"},"OpenLDAP"),(0,r.kt)("li",{parentName:"ul"},"Wireshark"),(0,r.kt)("li",{parentName:"ul"},"tcpdump")))),(0,r.kt)("h3",{id:"virtual-network-configuration"},"Virtual Network Configuration"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Default Virtual Network",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Network Address 192.168.122.0/24"),(0,r.kt)("li",{parentName:"ul"},"Network Type: NAT"))),(0,r.kt)("li",{parentName:"ul"},'Create the 2nd Virtual Network, named "opsnet"',(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Network Address 192.168.","[","x","]",".0/24 where ","[","x","]"," assigned by your professor"),(0,r.kt)("li",{parentName:"ul"},"Network Type: Isolated"))),(0,r.kt)("li",{parentName:"ul"},"Locate the ",(0,r.kt)("a",{parentName:"li",href:"/OPS535/C-ExtraResources/Get%20Device%20Name"},"name of the physical network device")," connected to the lab network. The following configuration assume eth3 as the device name name.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"assignment 172.16.","[","x","]",".1 to the alias of eth3: ifconfig eth3:0 172.16.","[","x","]",".1"))),(0,r.kt)("li",{parentName:"ul"},'Adding routes to each student\'s "opsnet" virtual network manually or by running the following bash script on the host OS:')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nip route add 192.168.1.0/24 via 172.16.1.1\nip route add 192.168.2.0/24 via 172.16.2.1\nip route add 192.168.3.0/24 via 172.16.3.1\nip route add 192.168.4.0/24 via 172.16.4.1\n...\nip route add 192.168.36.0/24 via 172.16.36.1\n")),(0,r.kt)("p",null,"or:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\ncount=1\nx=1 # my network id\nwhile [ ${count} -le 32 ]\ndo\n  if [ ${count} != ${x} ]\n  then\n      ip route add 192.168.${count}.0/24 via 172.16.${count}.1\n  fi\n  count=$(expr ${count} + 1)\ndone\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'You also need to add routes on all you VMs to each student\'s "opsnet" and the logical network "172.16.0.0" that connects all the hosts. You can do it manually or by running the following script on each of your VMs:')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nx=10 # my network id\nip route add 192.168.1.0/24 via 192.168.${x}.1\nip route add 192.168.2.0/24 via 192.168.${x}.1\nip route add 192.168.3.0/24 via 192.168.${x}.1\nip route add 192.168.4.0/24 via 192.168.${x}.1\n...\nip route add 192.168.36.0/24 via 192.168.${x}.1\nip route add 172.16..0/16 via 192.168.${x}.1\n")),(0,r.kt)("p",null,"or:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\ncount=1\nx=10 # my network id\nwhile [ ${count} -le 32 ]\ndo\n  if [ ${count} != ${x} ]\n  then\n      ip route add 192.168.1.0/24 via 192.168.${x}.1\n  fi\n  count=$(expr ${count} + 1)\ndone\nip route add 172.16..0/16 via 192.168.${x}.1\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'To test your static routes, pair up with a few fellow students and try to ping their VMs in their "opsnet".'),(0,r.kt)("li",{parentName:"ul"},"Save your network settings for the real lab."),(0,r.kt)("li",{parentName:"ul"},"Reboot your Host and restart all your VMs to confirm all the settings are correct.")),(0,r.kt)("h3",{id:"private-network-address-allocation"},"Private Network Address Allocation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/OPS535/C-ExtraResources/network-address"},"Network Address Allocation"))),(0,r.kt)("h2",{id:"centos-installation-and-update-issues"},"CentOS Installation and update Issues"),(0,r.kt)("p",null,"If you think that the yum update process takes too long to complete, inspect the file /etc/yum.repos.d/CentOS-Base.repo and add belmont to the baseurl under the ","[","base","]"," and ","[","updates","]"," sections:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"baseurl=http://belmont.senecac.on.ca/centos/$releasever/os/$basearch/\n")),(0,r.kt)("p",null,'Place the above line before the "mirrorlist=" line and try running yum update again.'),(0,r.kt)("h2",{id:"my-questions"},"My Questions"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"I can't ping other student's vms. What should I do to fix that?")),(0,r.kt)("p",null,"My Network is 192.168.x.0 and the other student's network is 192.168.y.0"),(0,r.kt)("h3",{id:"checks-the-following-setup"},"Checks the following setup"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"IP Addresses of your VMs"),(0,r.kt)("li",{parentName:"ol"},"IP Addresses of the other student's VMs"),(0,r.kt)("li",{parentName:"ol"},"IP address of the default gateway on your VMs, should be pointing to 192.168.122.1"),(0,r.kt)("li",{parentName:"ol"},"IP address of the default gateway on the other student's VMs, should be pointing to 192.168.122.1"),(0,r.kt)("li",{parentName:"ol"},"The kernel routing table on your host. Should have a route to 192.168.y.0 network via 172.16.y.1"),(0,r.kt)("li",{parentName:"ol"},"The kernel routing table on the other student's host. Should have a route to 192.168.x.0 via 172.16.x.1"),(0,r.kt)("li",{parentName:"ol"},'The ip_forward flag on your host, the contents of /proc/sys/net/ipv4/ip_forward should be set to "1"'),(0,r.kt)("li",{parentName:"ol"},'The ip_forward flag on the other student\'s host, the contents of /proc/sys/net/ipv4/ip_forward should be set to "1"'),(0,r.kt)("li",{parentName:"ol"},"A rule (or policy) in the FORWARD chain on your host's firewall to allow traffic between yours and the other student's VMs"),(0,r.kt)("li",{parentName:"ol"},"A rule (or policy) in the FORWARD chain on the other student's host's firewall to allow traffic between yours and the other student's VMs")),(0,r.kt)("p",null,"If all the above are set up properly, perform the following steps from one of your VMs:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"ping your gateway 192.168.x.1"),(0,r.kt)("li",{parentName:"ol"},"ping your host external IP 172.16.x.1"),(0,r.kt)("li",{parentName:"ol"},"ping the other student's external IP 172.16.y.1"),(0,r.kt)("li",{parentName:"ol"},"ping the other student's internal gateway 192.168.y.1"),(0,r.kt)("li",{parentName:"ol"},"ping the other student's VMs 192.168.y.z")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If you can ping 172.16.x.1 but not 172.16.y.1, make sure that your host can ping the other student's host."),(0,r.kt)("li",{parentName:"ul"},"If you can't ping 172.16.x.1, check your internet network setup."),(0,r.kt)("li",{parentName:"ul"},"If you can ping 172.16.y.1, but not 192.168.y.1, ask/help the other student to check the kernel routing table on its VM.")))}c.isMDXComponent=!0}}]);